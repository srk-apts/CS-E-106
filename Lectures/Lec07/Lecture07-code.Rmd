---
title: "Lecture07-code"
output: pdf_document
---

```{r}
bodyfat = read.csv("BodyFat.csv")
f = lm(Y~X1+X2+X3, data=bodyfat)
summary(f)
```


```{r}
f1 = lm(Y~X1+X2, data=bodyfat)
summary(f1)
```

**Note:** f = full model, f1 = reduced model (without X3). If the SSE of the reduced model is significantly increased compared to the SSE of the full model, we are going to reject the null hypothesis ($\beta_{3} = 0$)


```{r}
anova(f)
```

```{r}
anova(f1)
```


```{r}
F_star = (109.95-98.405)/6.15
F_star
```


```{r}
qf(1-0.05,1,16)
```

F_star = 1.877236 <= 4.493998 = F(1-0.05,1,16) $\implies$ conclude $H_{0}$.

X3 can be dropped from the model that already contains X1, X2.

OR...

```{r}
anova(f1, f, test="Chi")
```

Pr(>Chi) = 0.1706 which means there is no significant difference in the MSEs of Model 1 and Model 2, so we can drop X3.

```{r}
f2 = lm(Y~X1, data=bodyfat)
anova(f2, f, test="Chi")

```

Pr(>Chi) = 0.1706 which means there is significant difference in the MSEs of Model 1 and Model 2, so we cannot drop X2 and X3 at the same time.


```{r}
#install.packages("QuantPsyc")
library(QuantPsyc)
```


```{r}
# transformed betas
lm.beta(f)
```
```{r}
# original betas
f$coefficients
```

Multi-Collinearity

```{r}
rxx = cor(bodyfat[,1:3])
rxx
```

X1 and X2 are highly correlated to each other.

```{r}
summary(f)
```


```{r}
f3 = lm(Y~X1+X3, data=bodyfat)
summary(f3)
```


```{r}
library(faraway)
```

```{r}
#Variable Inflation Factor
vif(f)
```


```{r}
vif(f3)
```


```{r}
```


```{r}
```

